<html><head><title>dynamics-client: Sharepoint Sites</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="aappddeevv" /><meta name="description" content="A Microsoft Dynamics CLI swiss-army knife and browser/server library." /><meta name="og:image" content="/dynamics-client/img/poster.png" /><meta name="og:title" content="dynamics-client: Sharepoint Sites" /><meta name="og:site_name" content="dynamics-client" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="A Microsoft Dynamics CLI swiss-army knife and browser/server library." /><link rel="icon" type="image/png" href="/dynamics-client/img/favicon.png" /><meta name="twitter:title" content="dynamics-client: Sharepoint Sites" /><meta name="twitter:image" content="img/poster.png" /><meta name="twitter:description" content="A Microsoft Dynamics CLI swiss-army knife and browser/server library." /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/dynamics-client/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/dynamics-client/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/dynamics-client/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/dynamics-client/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/dynamics-client/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/dynamics-client/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/dynamics-client/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/dynamics-client/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/dynamics-client/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/dynamics-client/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/dynamics-client/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/dynamics-client/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/dynamics-client/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/dynamics-client/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/dynamics-client/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/dynamics-client/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/dynamics-client/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/dynamics-client/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/dynamics-client/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/dynamics-client/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/dynamics-client/highlight/styles/default.css" /><link rel="stylesheet" href="/dynamics-client/css/style.css" /><link rel="stylesheet" href="/dynamics-client/css/palette.css" /><link rel="stylesheet" href="/dynamics-client/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/dynamics-client/" class="brand"><div class="brand-wrapper"><span>dynamics-client</span></div></a></li>                    </ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/aappddeevv/dynamics-client"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/aappddeevv/dynamics-client"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('dynamics-client A Microsoft Dynamics CLI swiss-army knife and browser/server library.');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('dynamics-client A Microsoft Dynamics CLI swiss-army knife and browser/server library.');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="aappddeevv" data-github-repo="dynamics-client"><div class="content-wrapper"><section><h1 id="configuring-sharepoint-sites">Configuring Sharepoint Sites</h1>

<p>Sharepoint sites in dynamics are kept as “sharepointlocation” records. To help,
as much as possible, automate deployment to a new org or when you are testing
deployments in general, you want to load the sharepoint site record as
configuration data. The dynamics team provides a “configuration data”
program. But we can do that quite easy just by upserting a record.</p>

<ul>
  <li>Create a json record of the sharepoint site including a guid.</li>
  <li>Use dynamicscl to “update” (really upsert) the record into the target org.</li>
  <li>Don’t forget to “manually” validate the site. You can’t automate this through
an action/function at this time.</li>
</ul>

<p>Here’s a sharepoint record to keep as a file. I did not create this by hand,
merely dumped the existing record from a dev site and then deleted non-essential
fields.</p>

<p>Dump:</p>

<div class="language-sh highlighter-rouge"><pre class="highlight"><code>dynamicscli entity <span class="nb">export</span>-from-query <span class="s1">'/sharepointsites'</span> --outputfile sharepointsites.json
</code></pre>
</div>

<p>The record with some manual edits. You must create the guid id or use the one from the dump file above, which is perfectly fine. The CLI <a href="https://stedolan.github.io/jq/">jq</a> and its tutorial <a href="https://shapeshed.com/jq-json/">tutorial</a> may be helpful for manipulating json data extracted from dynamics.</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"sharepointsiteid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"baff8d69-b231-e811-a94d-000d3a36399f"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Document storage"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"ispowerbisite"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"servicetype"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"absoluteurl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://yourorg.sharepoint.com/sites/DynamicsCRMYeah"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DynamicsCRMYeah"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"folderstructureentity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"none"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>The load:</p>

<div class="language-sh highlighter-rouge"><pre class="highlight"><code>dynamicscli update entity sharepointsites sharepointsite.json --pk sharepointsiteid --upsertpreventcreate <span class="nb">false</span>
</code></pre>
</div>

<p>Specifically for the sharepoint site, you may need to add the “grid” component
and validate it for use prior to using it. These steps are not subject to
automation at this time.</p>

<p>You can do this for any type of configuration data that you wish to upload for a
new dynamics org.</p>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/dynamics-client/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script src="/dynamics-client/js/main.js"></script></body></html>